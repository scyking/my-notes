# go 初始化顺序

标签（空格分隔）： go

---

[toc]

## 初始化顺序

> 在一个go文件中， 初始化顺序规则如下：

1. 当前包中的常量
2. 当前包中的变量
3. 当前包`init()`初始化函数。（`init()`函数自动被调用，不可以显示调用或被引用）
4. `main()`函数

## 包初始化规则

- 在 `main` 包中的 go 文件默认总是会被执行
- 同包下的不同 go 文件，按照文件名**从小到大**排序顺序执行
- 其他的包只有被 `main` 包 `import` 才会执行，按照 `import` 的先后顺序执行
- 被递归 `import` 的包的初始化顺序与 `import` 顺序相反。例如：导入顺序 `main –> A –> B –> C`，则初始化顺序为 `C –> B –> A –> main`
- 一个包被其它多个包 `import`，但只能被初始化一次
- `main`包总是被最后一个初始化（因为`main`总是依赖别的包，被依赖的总是先被初始化）

## 注意事项

- 避免出现循环 `import`。例如：`A –> B –> C –> A`

## `init` 和 `main` 对比

### 相同点

- 两个函数在定义时不能有任何的参数和返回值
- 该函数只能由 go 程序自动调用，不可以被引用

### 不同点

- `init` ：可以应用于任意包中，且可以重复定义多个
- `main` ：只能用于 `main` 包中，且只能定义一个
