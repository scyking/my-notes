# linux 文件权限

标签（空格分隔）： linux

---

[toc]

## 概述

> Linux下所有资源、设备均被视作文件来操作。文件权限是决定用户可对各文件操作的范围。

## 文件权限

> 用户获取文件权限的顺序，`Owner > Group > Others`。

![文件权限](http://assets.processon.com/chart_image/60d18ea61e085301d0ede3a2.png)

- 文件类型
  - `-`，普通文件
  - `d`，目录文件
  - `l`，符号链接
  - `c`，字符设备文件
  - `b`，字节设备文件
  - `p`，先进先出文件
  - `s`，套接字文件

- 文件的权限针对三类对象进行定义
  - `owner` 属主，缩写u
  - `group` 属组，缩写g
  - `other` 其他，缩写o

- 主要权限
  - `r`：Read， 读（`4`）
  - `w`：Write，写（`2`）
  - `x`：execute， 执行（`1`）

### 普通权限

|权限|文件|目录|
|---|---|---|
|r，读权限| 查看文件内容| 列出其子目录结构信息（就是可执行 `ls 目录` ）
|w，写权限| 配合`r`权限，则可对文件进行修改和删除| 配合x权限就可以添加、删除和移动内部文件，而删除目录和复制目录内文件则需要配合`r`和`x`权限。
|x，执行权限| 配合`r`权限，可执行的权限| 可以进入该目录和对其下文件作操作（就是可执行 `cd 目录` ）

### 特殊权限

> Linux的文件权限除了`rwx`之外，还有`s`和`t`这两个特殊权限。

- 特殊权限说明

|权限|文件|目录|位置|颜色表现|
|---|---|---|---|---|
|`SUID`（Set UID）|注意：仅对**二进制可执行文件**设置</br>二进制可执行文件会以所有者和调用者的用户标识去执行，也就是拥有两者的权限。|不对目录设置|设置在`Owner`中。</br>`s`表示二进制可执行文件同时拥有`SUID`权限和`x`可执行权限；</br>`S`表示二进制可执行文件拥有`SUID`权限但没有`x`可执行权限。|红色|
|`SGID`（Set GID）|注意：仅对二进制可执行文件设置</br>二进制可执行文件会以所属组和调用者的标识去执行，也就是拥有两者的权限。|在目录下创建文件、目录等，其所属组与该目录的所属组相同。而不是所有者的用户组了。|设置在`Group`中。</br>`s`表示二进制可执行文件或目录同时拥有SGID权限和`x`可执行权限；</br>`S`表示二进制可执行文件或目录拥有`SGID`权限但没有`x`可执行权限。|黄色|
|`SBIT`（Sticky BIT）|不对文件设置|配合`wx`权限，仅目录的所有者、子目录或文件的所有者和root用户才能删除、移动该目录下的子目录和文件|设置在`Others`中。</br>`t`表示目录同时拥有SBIT权限和x可执行权限；</br>`T`表示目录拥有`SBIT`权限但没有`x`可执行权限。|绿色|

## 修改文件权限方法

### 文字法

- 普通权限

    ```bash
    chmod [who] [opt] [per] <file>
    
        [who]：u g o a（all）
        [opt]：+ – =
        [per]：r w x X
    ```

- 特殊权限

    ```bash
    // 开启、关闭SUID
    chmod u+s 文件名
    chmod u-s 文件名
    
    // 开启、关闭SGID
    chmod g+s 文件名
    chmod g-s 文件名
    
    // 开启、关闭SBIT
    chmod o+t 文件名
    chmod o-t 文件名
    ```

### 数字法

> 权限数字相加。

- 普通权限

    ```bash
    chmod [XXX] <file>
    
        [r]：4
        [w]：2
        [x]：1
    ```

- 特殊权限
    > 将原来的三位数扩展为四位数，放在权限数字的最开头。

  - SUID：4
  - SGID：2
  - SBIT：1

## 常用命令

- `whoami` 查看当前用户
- `groups` 查看当前用户所属组
- `chown` 设置文件所有者（普通用户无法修改文件所有者）
- `chgrp` 设置文件所属组（普通用户要想该所属组，前提是文件所有者为自己，自己在所属组中）
- `chmod` 设置指定文件权限
- `chattr` 给指定文件添加保护，避免root账户误操作
