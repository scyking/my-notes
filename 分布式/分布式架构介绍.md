# 分布式架构介绍

标签（空格分隔）： 分布式

---

[toc]

## 分布式发展历程

### 单点集中式

> App、DB、FileServer都部署在⼀台机器上。并且访问请求量较少

### 应⽤服务和数据服务拆分

> App、DB、FileServer分别部署在独⽴服务器上。并且访问请求量较少

### 使⽤缓存改善性能

> 数据库中频繁访问的数据存储在缓存服务器中，减少数据库的访问次数，降低数据库的压⼒

### 应⽤服务器集群

> 多台应⽤服务器通过负载均衡同时对外提供服务，解决单台服务器处理能⼒上限的问题

### 数据库读写分离

> 数据库进⾏读写分离（主从）设计，解决数据库的处理压⼒

### 反向代理和CDN加速

> 采⽤反向代理和CDN加快系统的访问速度

### 分布式⽂件系统和分布式数据库

> 数据库采⽤分布式数据库，⽂件系统采⽤分布式⽂件系统。
> 分布式数据库是数据库拆分后的最后⽅法，只有在单表规模⾮常庞⼤的时候才使⽤，更常⽤的数据库拆分⼿段是业务分库，将不
同业务的数据库部署在不同的机器上

## 分布式事务

### ACID特性

- 原子性（`Atomicity`）
    事务中包含的所有操作要么全部成功，要么全部失败回滚。
- 一致性（`Consistency`）
    事务执行前和执行后必须处于一致性状态。
- **隔离性**（`Isolation`）
    当多个用户并发访问数据库时，数据库为每一个用户开启的事务，不被其他事务的操作所干扰，多个并发事务之间要相互隔离。
- 持久性（`Durability`）
    一个事务一旦被提交了，那么对数据库中的数据的改变就是永久性的，即便在数据库系统遇到故障的情况下也不会丢失事物的操作。

### 事务隔离级别

- 读未提交（Read uncommitted）
- 读已提交（read committed）
- 可重复读（repeatable read）
- 串⾏化（Serializable）

### 2P/3P

> 为了保证事务的ACID特性。

- `2P= Two Phase commit`    ：⼆段提交（RDBMS（关系型数据库管理系统）经常就是这种机制，保证强⼀致性）
- `3P= Three Phase commit`  ：三段提交

### CAP理论

- ⼀致性（Consistency）：分布式数据库的数据保持⼀致
- 可⽤性（Availability）：任何⼀个节点挂了，其他节点可以继续对外提供服务
- 分区容错性（⽹络分区）（Partition tolerance）：⼀个数据库所在的机器坏了，如硬盘坏了，数据丢失了，可以新增⼀台机器，然
后从其他正常的机器把备份的数据同步过来

CAP只能满⾜其中2条。

1. CA(放弃P)：将所有的数据放在⼀个节点。满⾜⼀致性、可⽤性。
1. AP(放弃C)：放弃强⼀致性，⽤最终⼀致性来保证。
1. CP(放弃A)：⼀旦系统遇⻅故障，受到影响的服务器需要等待⼀段时间，在恢复期间⽆法对外提供服务。

### BASE理论

- 基本可⽤（bascially available）：在分布式系统出现故障，允许损失部分可⽤性（服务降级、⻚⾯降级）
- 软状态（soft state）：允许分布式系统出现中间状态。⽽且中间状态不影响系统的可⽤性。
- 最终⼀致性（Eventually consistent）：经过⼀段时间达到⼀致性。

### Paxos算法

> Paxos算法是基于消息传递且具有高度容错特性的一致性算法，是目前公认的解决分布式一致性问题最有效的算法之一，其解决的问题就是在分布式系统中如何就某个值（决议）达成一致。
